(()=>{var e={};e.id=914,e.ids=[914],e.modules={55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},25528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},91877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},25319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},39491:e=>{"use strict";e.exports=require("assert")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},12781:e=>{"use strict";e.exports=require("stream")},76224:e=>{"use strict";e.exports=require("tty")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},53454:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>d,routeModule:()=>x,tree:()=>c});var s=r(67096),a=r(16132),l=r(37284),i=r.n(l),n=r(32564),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);r.d(t,o);let c=["",{children:["(admin)",{children:["image-and-categories",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,27099)),"C:\\Users\\hp\\Desktop\\imagin for personal\\src\\app\\(admin)\\image-and-categories\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,42430)),"C:\\Users\\hp\\Desktop\\imagin for personal\\src\\app\\(admin)\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,9291,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,63976)),"C:\\Users\\hp\\Desktop\\imagin for personal\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,9291,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],d=["C:\\Users\\hp\\Desktop\\imagin for personal\\src\\app\\(admin)\\image-and-categories\\page.tsx"],u="/(admin)/image-and-categories/page",p={require:r,loadChunk:()=>Promise.resolve()},x=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/(admin)/image-and-categories/page",pathname:"/image-and-categories",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},43167:(e,t,r)=>{Promise.resolve().then(r.bind(r,15197))},15197:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>ImageCategories});var s=r(30784),a=r(9885),l=r(79636),i=r.n(l),n=r(7070),o=r(72804),c=r(68602),d=r(27487),u=r.n(d),p=r(71319),x=r(33503),g=r(23458),m=r(33708),h=r(11761),f=r(75130),b=r(52451),y=r.n(b),j=r(53275),v=r(78138);function AddCategory({setIsOpen:e,isOpen:t,refetch:r}){let[l,i]=(0,a.useState)(""),n=(0,p.useMutation)({mutationKey:["create-mutation"],mutationFn:e=>f.x.post("/categories/create/",e),onSuccess:()=>{c.ZP.success("Category is created successfully"),r(),e(!1),i("")},onError:e=>{console.log("Error message from API",e),c.ZP.error("Category already exist")}});return s.jsx(j.Z,{closeIcon:s.jsx(y(),{src:v.Z,alt:"cross-icon"}),className:"h-[300px]",width:348,open:t,footer:null,onOk:()=>{e(!1)},children:(0,s.jsxs)("form",{onSubmit:e=>{e.preventDefault(),n.mutate({categories_name:l})},layout:"vertical",className:"flex flex-col items-center  bg-[#141414] p-5",children:[s.jsx("label",{className:" text-white text-center self-start text-[22px] mt-10 pb-2 !text-xl font-bold",children:"Category Name"}),s.jsx("input",{type:"text",required:!0,placeholder:"Enter category name",value:l,onChange:e=>i(e.target.value),className:"w-full !bg-[#141414] text-white border border-gray-600 placeholder:!text-[#505050] py-2 rounded-xl px-4 text-[18px]"}),(0,s.jsxs)("div",{className:"flex flex-col w-full gap-y-4 mt-6",children:[s.jsx("button",{type:"submit",loading:n.isLoading,className:"ant-btn-tertuary flex items-center justify-center bg-purple-500 w-full text-[20px] text-white py-2 hover:!bg-[#c779d0] rounded-xl",children:"Add"}),s.jsx("button",{type:"button",onClick:()=>{e(!1),i("")},className:"ant-btn-secondary flex items-center justify-center w-full text-[20px] text-white cursor-pointer",children:"Cancel"})]})]})})}let w=[{tabKey:1,tabText:"Images",content:s.jsx(function(){let e=(0,p.useQueryClient)(),{ref:t,inView:r}=(0,x.YD)(),[l,d]=(0,a.useState)(""),[b,j]=(0,a.useState)(!1),[v,w]=(0,a.useState)(!1),[N,_]=(0,a.useState)(0),[P,C]=(0,a.useState)(""),[q,k]=(0,a.useState)({page:1,page_size:20}),{adminAllImages:Z,setAdminAllImages:A,adminFetchAllData:I,setAdminFetchAllData:S}=(0,g.o)();u()(()=>{let{scrollTop:e,scrollHeight:t,clientHeight:r}=document.documentElement,s=+(e/(t-r)*100).toFixed(1);console.log(s>90,v,I),!(s>90)||v||I?s<90&&v&&w(!1):(w(!0),k(e=>({...e,page:e.page+1})))},200);let D=(0,p.useMutation)({mutationKey:["upload-csv"],mutationFn:async e=>{let t=await f.x.post("/process-csv/",e);return _(t?.data?.response?.length||0),t},onSuccess:async({data:e})=>{j(!0);let t=e?.response?.map(async e=>{try{let t=await f.x.post("/generate-image/",{prompt:e});t&&_(e=>e-1);let r={imageId:t?.data?.image_id,imageUrl:t?.data?.generated_image_url};A([r,...Z])}catch(e){console.error("Error in generate-image API call",e)}});await Promise.all(t),j(!1)}});console.log(N,"original length");let{data:E,fetchNextPage:K,hasNextPage:F,isFetchingNextPage:M}=(0,p.useInfiniteQuery)({queryKey:["get-all-images"],queryFn:({pageParam:e=1})=>f.x.get(`categories/all/images/?page=${e}&page_size=10`).then(({data:e})=>e),getNextPageParam:(e,t)=>{let r=t?.length?t?.length+1:void 0;return r},getPreviousPageParam:(e,t)=>e.prevCursor});(0,a.useEffect)(()=>{r&&F&&K()},[r,F,K]);let G=(0,p.useMutation)({mutationKey:["delete-image-by-id"],mutationFn:async e=>f.x.delete(`/delete-image/${e}/`),onSuccess:()=>{c.ZP.success("Image successfull deleted"),e.invalidateQueries("get-all-images")},onError:e=>{c.ZP.error("Failed to delete image")}});return(0,s.jsxs)("div",{className:"flex flex-col border border-gray-600 rounded-2xl w-full text-white",children:[(0,s.jsxs)("header",{className:"flex items-center justify-between p-5 border-b border-gray-600",children:[(0,s.jsxs)("div",{className:"",children:[s.jsx("h1",{className:"text-2xl font-bold",children:`Images (${E?.pages[0]?.count})`}),s.jsx("span",{children:"Generate Images By Uploading Prompts"})]}),s.jsx(o.Z,{onChange({file:e,fileList:t}){if(console.log("Props function fired"),"uploading"!==e.status){d(t[0]?.name);let e=new FormData;e.append("file",t[0]?.originFileObj),D.mutateAsync(e)}},multiple:!0,children:(0,s.jsxs)(i(),{type:"primary",className:"bg-purple-500/20 border border-purple-600 text-purple-600 font-sans",children:[s.jsx(y(),{src:m.Z,alt:"plus-icon",className:"mr-2 !text-purple-600"}),"  Upload .csv"]})})]}),(0,s.jsxs)("main",{className:"p-2 md:p-5 flex flex-col gap-y-4 w-full",children:[l&&(0,s.jsxs)("section",{className:"flex justify-between text-xl",children:[s.jsx("h1",{className:"",children:l||"New Promt files.csv"}),s.jsx("h1",{className:"text-yellow",children:"Generate Images"})]}),(0,s.jsxs)("section",{className:"w-full grid gap-x-2 md:gap-x-5 grid-cols-1 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4",children:[b&&Array.from({length:N}).map((e,t)=>s.jsx("div",{role:"status",className:"w-full h-[205px] border border-gray-200 relative overflow-hidden rounded-xl shadow animate-pulse  dark:border-gray-700",children:s.jsx("div",{className:"flex items-center h-full justify-center bg-yellow rounded dark:bg-gray-700",children:(0,s.jsxs)("svg",{className:"w-10 h-10 text-gray-200 dark:text-gray-600","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 16 20",children:[s.jsx("path",{d:"M14.066 0H7v5a2 2 0 0 1-2 2H0v11a1.97 1.97 0 0 0 1.934 2h12.132A1.97 1.97 0 0 0 16 18V2a1.97 1.97 0 0 0-1.934-2ZM10.5 6a1.5 1.5 0 1 1 0 2.999A1.5 1.5 0 0 1 10.5 6Zm2.221 10.515a1 1 0 0 1-.858.485h-8a1 1 0 0 1-.9-1.43L5.6 10.039a.978.978 0 0 1 .936-.57 1 1 0 0 1 .9.632l1.181 2.981.541-1a.945.945 0 0 1 .883-.522 1 1 0 0 1 .879.529l1.832 3.438a1 1 0 0 1-.031.988Z"}),s.jsx("path",{d:"M5 5V.13a2.96 2.96 0 0 0-1.293.749L.879 3.707A2.98 2.98 0 0 0 .13 5H5Z"})]})})},t)),E?.pages?.map((e,t)=>e?.results?.map((e,t)=>s.jsxs("div",{className:"relative overflow-hidden rounded-xl h-[205px] select-none",children:[s.jsx(y(),{className:"h-full w-full  object-cover",src:e?.image_path,alt:e?.image_id,width:400,height:400},e?.image_id),s.jsx("div",{className:"absolute bg-gradient-to-b from-black/80 to-transparent top-0 w-full h-full z-20",children:s.jsx(i(),{loading:G.isLoading&&G.variables===e?.image_id,icon:s.jsx(y(),{src:h.Z,alt:"alt-icon"}),onClick:()=>{C(e?.image_id),G?.mutate(e?.image_id)},className:"absolute right-3 top-3 flex items-center justify-center w-8 h-8 rounded-lg bg-black/50 backdrop-blur-xl"})})]},e?.image_id)))]}),s.jsx("div",{ref:t,className:"flex items-center w-full justify-center",children:M&&s.jsx(n.default,{})})]})]})},{})},{tabKey:2,tabText:"Categories",content:s.jsx(function(){let[e,t]=(0,a.useState)(!1),handleDeleteCategory=e=>{o.mutate(e)},{data:r,isLoading:l,refetch:n}=(0,p.useQuery)({queryKey:["get-all-category"],queryFn:async()=>f.x.get("/categories/").then(({data:e})=>e||[]).catch(e=>console.log(e,"this is error"))}),o=(0,p.useMutation)({mutationKey:["delete-category"],mutationFn:e=>f.x.delete(`/categories/delete/${e}`),onSuccess:()=>{c.ZP.success("Category is successfully deleted"),n()},onError:(e,t)=>{console.log(e),c.ZP.error(`Failed to delete category with id=${t}`)}});return(0,s.jsxs)("div",{className:"flex flex-col border border-gray-600 rounded-2xl text-white",children:[(0,s.jsxs)("header",{className:"flex items-center justify-between p-5 border-b border-gray-600",children:[(0,s.jsxs)("div",{className:"",children:[(0,s.jsxs)("h1",{className:"text-2xl font-bold",children:["Categories (",r?.length,")"]}),s.jsx("span",{children:"Manage Your Categories Here"}),s.jsx("span",{})]}),s.jsx(i(),{type:"primary",onClick:()=>t(!0),className:"bg-purple-500/20 border border-purple-600 text-purple-600 font-sans",icon:s.jsx(y(),{src:m.Z,alt:"plus-icon"}),children:"Add Category"})]}),l?s.jsx("h1",{className:"text-center px-8 py-12 text-lg",children:"loading..."}):s.jsx("main",{className:"flex flex-col gap-y-4 pb-10",children:r?.map(({categories_id:e,categories_name:t})=>s.jsxs("section",{className:"flex justify-between text-xl border-b border-gray-600 p-5",children:[s.jsx("h1",{className:"",children:t}),s.jsx("span",{onClick:()=>handleDeleteCategory(e),className:"text-red-600 cursor-pointer uppercase font-bold tracking-widest pr-1  md:pr-8",children:"Remove"})]},e))}),s.jsx(AddCategory,{setIsOpen:t,isOpen:e,refetch:n})]})},{})}];function ImageCategories(){let[e,t]=(0,a.useState)(1),r=(0,g.o)(e=>e.userData);return console.log("userData",r),(0,s.jsxs)("div",{children:[s.jsx("div",{className:"grid grid-cols-[100px_100px] px-10 items-center border-b border-gray-600 text-center pt-5 text-white ",children:w.map(r=>s.jsx("div",{className:`${e===r.tabKey?"transition-all duration-800 delay-100 text-yellow font-bold tab-gradient border-b-4 border-yellow":""} cursor-pointer w-full text-base lg:text-xl py-2`,onClick:()=>t(r.tabKey),children:r.tabText},r.tabKey))}),s.jsx("div",{className:"relative py-5 px-3 md:px-10",children:(e=>{let t=w.find(t=>t.tabKey===e);return t?s.jsx("h1",{children:t.content}):s.jsx("h1",{children:"No Tabs found"})})(e)})]})}},27099:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>ImageAndCategories});var s=r(4656);r(3542);var a=r(95153);let l=(0,a.createProxy)(String.raw`C:\Users\hp\Desktop\imagin for personal\src\components\ImagesAndCategories\page.tsx`),{__esModule:i,$$typeof:n}=l,o=l.default;function ImageAndCategories(){return s.jsx(o,{})}},11761:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});let s={src:"/_next/static/media/delete.f5b8a014.svg",height:20,width:18,blurWidth:0,blurHeight:0}},33708:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});let s={src:"/_next/static/media/plus.a31b4988.svg",height:12,width:13,blurWidth:0,blurHeight:0}},78138:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});let s={src:"/_next/static/media/small-cross.2ab7fe01.svg",height:7,width:7,blurWidth:0,blurHeight:0}}};var t=require("../../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[52,694,440,641,602,490,275,487,30,488,241,115],()=>__webpack_exec__(53454));module.exports=r})();